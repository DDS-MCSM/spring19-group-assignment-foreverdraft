---
title: "AssigmentDocumented"
author: "Group4"
date: "5/24/2019"
output: html_document
---

```{r load_packages, echo = FALSE, cache = TRUE}
# Paquetes necesarios
pkg <- c("dplyr","ggplot2", "scales", "maptools", "sp", "maps", "grid", "Group4","mapproj","rgdal","leaflet","rworldmap")

# Instalar paquetes que no esten instalados
new.pkg <- pkg[!(pkg %in% installed.packages())]
if (length(new.pkg))
{
     install.packages(new.pkg)  
}

library(ggplot2)
library(scales)
library(maptools)
library(sp)
library(maps)
library(grid)
library(Group4)
library(mapproj)
library(dplyr)
library(leaflet)
library(rworldmap)

```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Feodo

En este Markdown se intenta representar el número de botnets activas. El dataset utilizado se actualiza cada 5 minutos.

La fuente de los datos utilizados es accesible desde el siguiente enlace <https://feodotracker.abuse.ch/>.  


## Including Map
```{r map, include=FALSE, cache=TRUE}
# Cargamos el dataset con las coordenadas de Lat/Long
df.feo<-maxmindg4.df()
```

```{r display, include=FALSE}
# Mostrem el dataset obtingut
str(df.feo)
```
Mapa con la ubicación de las botnets.
```{r map_simple, echo=FALSE, cache=TRUE, fig.align='center'}
world <- map_data("world")
# Quitamos el continete Antarctico ya que no aporta informaci?n
# No es nada personal con los pinguinos...
world <- subset(world, world$region!="Antarctica")

gg <- ggplot(data=world, aes(x=long, y=lat))
gg <- gg + geom_path(aes(group=group), colour="gray70")
# La definici?n de la proyeccion representa la "curvatura" del mapa
gg <- gg + coord_map("mercator", xlim=c(-200, 200))
# A?adimos una capa al mapa con la informaci?n de Zero Access
gg <- gg + geom_point(data=df.feo, aes(longitude, latitude),
                      colour="red", alpha=1/40, size=5)
# Eliminamos texto y le damos un poco de color
gg <- gg + theme(text=element_blank(),
                 axis.ticks=element_blank(),
                 panel.grid=element_blank(),
                 panel.background=element_rect(color="gray50",
                                               fill="white"))
print(gg)


```

```{r mapa, include=FALSE, cache=TRUE}
# Basic choropleth with leaflet?
leaflet(df.feo) %>%
addTiles()  %>%
setView( lat=10, lng=0 , zoom=2) %>% addCircles(lng = ~longitude, lat = ~latitude)
```
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
